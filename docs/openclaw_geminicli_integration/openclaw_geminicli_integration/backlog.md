# Backlog / 未着手課題・TODO リスト

現在のプロジェクトにおける、未実装の機能要望、改善案、バグ修正、および後回しにした技術的負債などを記録する場所です。
定期的に見直し、優先度の高いものから着手（または `devlog` / `task.md` へ移動）します。

## 優先度 高 (High Priority)
直近の開発セッションで着手すべき、またはシステムの安定性に直結する課題。

- [ ] **Windows 互換性の向上 (`start.bat` の作成)**
  - **詳細**: 現在 UNIX 系の `start.sh` しか存在しないため、Windows 環境でのポータビリティが不完全。
  - **対応方針**: `start.sh` と同等の機能を持つ `start.bat` を作成する。（`runbook.md` の更新も必要）
  - **起票日/起票元**: 2026-02-24 / ユーザー要望による

- [ ] **プロンプト中止（Abort）機能の実装**
  - **詳細**: Gemini CLI がツール実行中に無限ループした場合、バックグラウンドプロセスのため PID を手動で特定して `kill` するしかなく非常に困難。OpenClaw 本体はコマンド `/stop` 受信時に HTTP 接続を切断する仕様だが、現在のアダプタは切断後もプロセスを殺さないためリソースが残り続ける。
  - **対応方針（クリーンな HTTP 切断検知方式）**:
    1. `server.js` および `streaming.js` で、クライアント（OpenClaw）からの HTTP 接続が切断されたイベント（`req.on('close')` または `res.on('close')`）をフックする
    2. 切断を検知した場合、該当リクエストを処理中の `RunnerPool` の runner（Gemini CLI）プロセスに直ちに `SIGKILL` を送信して強制終了する
    3. 同時に、RunnerPool のキュー内の同セッションの待機プロンプトがあれば破棄し、不完全な履歴のクリーンアップを行う
  - **正当性**: SSE ストリーミングにおいて、クライアントの接続が切れた時点でどうせ返答は届けられない。意図的な `/stop` であれ、ネットワーク瞬断であれ、裏で回り続けるプロセスを破棄してリソースを解放するのはサーバーとして不可欠な正しい振る舞いである。
  - **起票日/起票元**: 2026-02-24 / ユーザー要望（無限ループ実体験に基づく）

- [ ] **GoogleDrive_Sync 同期フォルダのファイル再構成**
  - **詳細**: FUSEハング解消のため、元の `Global_Env/home/` 下の `.claude.json` や `ai_tools/` フォルダなどを一時的に空ファイルやシンボリックリンク解除で対処している状態。
  - **対応方針**: ローカル環境（`~/.local` や `~/.config`）への永続的な移行を完了させるか、安全な形でファイルを再構築する。
  - **起票日/起票元**: 2026-02-24 / devlog セッション9 より

## 優先度 中 (Medium Priority)
時間がある時に着手したい改善や、UX向上のための課題。

- [ ] **`adapter.js` (旧ファイル) のクリーンアップ**
  - **詳細**: セッション4でモジュール分離した際、古い 939行の `adapter.js` や不要な残骸がそのまま残っている可能性がある。
  - **対応方針**: 古い巨大ファイルを削除し、不要なファイル群を整理する。
  - **起票日/起票元**: 2026-02-21 / devlog セッション4 より

## 優先度 低 / アイデア (Low Priority / Idea)
「いつかやりたい」レベルの構想、または優先順位が下がった課題。

- [ ] **ブラウザツール (`browser`) の Gemini CLI 統合の再評価**
  - **詳細**: 現在は Gemini 側の `google_web_search` が強力なため OpenClaw 提供の `browser` ツールを「使用不能（除外）」としているが、特定サイトの操作などで将来的に必要になる可能性がある。
  - **対応方針**: `google_web_search` でカバーしきれないユースケース（Playwright 経由の DOM 操作など）が発生した時点で対応を検討する。
  - **起票日/起票元**: 2026-02-24 / devlog セッション12 より

---
**運用ルール**:
- 課題が解決・実装されたら、リストから削除するか、`[x]` にチェックして「完了済み」セクションへ移動（または削除してコミットログに任せる）します。
- 新しく課題を「後回し」にした際は、必ずこのファイルの適切な優先度のセクションに追記してください。
